<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1381px" preserveAspectRatio="none" style="width:1522px;height:1381px;" version="1.1" viewBox="0 0 1522 1381" width="1522px" zoomAndPan="magnify"><defs><filter height="300%" id="f6bct15kra8wp" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="193" x="665.75" y="23.5352">Data submission sequence</text><rect fill="#DDDDDD" height="1328.6465" style="stroke: #A80036; stroke-width: 1.0;" width="64" x="257.5" y="34.4883"/><rect fill="#DDDDDD" height="1328.6465" style="stroke: #A80036; stroke-width: 1.0;" width="687" x="396.5" y="34.4883"/><rect fill="#FFFFFF" filter="url(#f6bct15kra8wp)" height="433.3477" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="284.5" y="187.5977"/><rect fill="#FFFFFF" filter="url(#f6bct15kra8wp)" height="68.6211" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="284.5" y="858.4531"/><rect fill="#FFFFFF" filter="url(#f6bct15kra8wp)" height="255.7949" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="453.5" y="296.5293"/><rect fill="#FFFFFF" filter="url(#f6bct15kra8wp)" height="57.3105" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="653.5" y="465.7031"/><rect fill="#FFFFFF" filter="url(#f6bct15kra8wp)" height="554.3027" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="653.5" y="804.832"/><rect fill="#FFFFFF" filter="url(#f6bct15kra8wp)" height="14" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="812" y="495.0137"/><rect fill="#FFFFFF" filter="url(#f6bct15kra8wp)" height="83.9316" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1005.5" y="971.3398"/><rect fill="#FFFFFF" filter="url(#f6bct15kra8wp)" height="14" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1156.5" y="1146.8926"/><rect fill="#FFFFFF" filter="url(#f6bct15kra8wp)" height="14" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1156.5" y="1245.5137"/><rect fill="#FFFFFF" filter="url(#f6bct15kra8wp)" height="304.0605" style="stroke: #000000; stroke-width: 2.0;" width="918.5" x="181" y="766.2109"/><rect fill="#FFFFFF" filter="url(#f6bct15kra8wp)" height="243.4395" style="stroke: #000000; stroke-width: 2.0;" width="898.5" x="191" y="819.832"/><rect fill="#FFFFFF" height="128.1973" style="stroke: none; stroke-width: 1.0;" width="898.5" x="191" y="935.0742"/><rect fill="#FFFFFF" filter="url(#f6bct15kra8wp)" height="84.6211" style="stroke: #000000; stroke-width: 2.0;" width="1124.5" x="119" y="1084.2715"/><rect fill="#FFFFFF" filter="url(#f6bct15kra8wp)" height="84.6211" style="stroke: #000000; stroke-width: 2.0;" width="1230.5" x="13" y="1182.8926"/><rect fill="#FFFFFF" filter="url(#f6bct15kra8wp)" height="70.6211" style="stroke: #000000; stroke-width: 2.0;" width="954.5" x="557" y="1281.5137"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="71" x2="71" y1="116.9766" y2="693.2559"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="71" x2="71" y1="693.2559" y2="734.2109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="71" x2="71" y1="734.2109" y2="1369.1348"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="147" x2="147" y1="116.9766" y2="693.2559"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="147" x2="147" y1="693.2559" y2="734.2109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="147" x2="147" y1="734.2109" y2="1369.1348"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="289.5" x2="289.5" y1="116.9766" y2="693.2559"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="289.5" x2="289.5" y1="693.2559" y2="734.2109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="289.5" x2="289.5" y1="734.2109" y2="1369.1348"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="458.5" x2="458.5" y1="116.9766" y2="693.2559"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="458.5" x2="458.5" y1="693.2559" y2="734.2109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="458.5" x2="458.5" y1="734.2109" y2="1369.1348"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="658" x2="658" y1="116.9766" y2="693.2559"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="658" x2="658" y1="693.2559" y2="734.2109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="658" x2="658" y1="734.2109" y2="1369.1348"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="817" x2="817" y1="116.9766" y2="693.2559"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="817" x2="817" y1="693.2559" y2="734.2109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="817" x2="817" y1="734.2109" y2="1369.1348"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1010.5" x2="1010.5" y1="116.9766" y2="693.2559"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1010.5" x2="1010.5" y1="693.2559" y2="734.2109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1010.5" x2="1010.5" y1="734.2109" y2="1369.1348"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1161.5" x2="1161.5" y1="116.9766" y2="693.2559"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1161.5" x2="1161.5" y1="693.2559" y2="734.2109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1161.5" x2="1161.5" y1="734.2109" y2="1369.1348"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1324.5" x2="1324.5" y1="116.9766" y2="693.2559"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1324.5" x2="1324.5" y1="693.2559" y2="734.2109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1324.5" x2="1324.5" y1="734.2109" y2="1369.1348"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1458.5" x2="1458.5" y1="116.9766" y2="693.2559"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1458.5" x2="1458.5" y1="693.2559" y2="734.2109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1458.5" x2="1458.5" y1="734.2109" y2="1369.1348"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="23" y="114.0234">Service Team</text><ellipse cx="71" cy="43.4883" fill="#FEFECE" filter="url(#f6bct15kra8wp)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M71,51.4883 L71,78.4883 M58,59.4883 L84,59.4883 M71,78.4883 L58,93.4883 M71,78.4883 L84,93.4883 " fill="none" filter="url(#f6bct15kra8wp)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="129" y="114.0234">User</text><ellipse cx="147.5" cy="43.4883" fill="#FEFECE" filter="url(#f6bct15kra8wp)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M147.5,51.4883 L147.5,78.4883 M134.5,59.4883 L160.5,59.4883 M147.5,78.4883 L134.5,93.4883 M147.5,78.4883 L160.5,93.4883 " fill="none" filter="url(#f6bct15kra8wp)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="261.5" y="114.0234">Runner</text><path d="M269,72.4883 L269,96.4883 M269,84.4883 L286,84.4883 " fill="none" filter="url(#f6bct15kra8wp)" style="stroke: #A80036; stroke-width: 2.0;"/><ellipse cx="298" cy="84.4883" fill="#FEFECE" filter="url(#f6bct15kra8wp)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f6bct15kra8wp)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="112" x="400.5" y="81.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="407.5" y="102.0234">Submittter API</text><rect fill="#FEFECE" filter="url(#f6bct15kra8wp)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="141" x="586" y="81.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="127" x="593" y="102.0234">Submitter Workers</text><rect fill="#FEFECE" filter="url(#f6bct15kra8wp)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="148" x="741" y="81.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="134" x="748" y="102.0234">Submitter Database</text><rect fill="#FEFECE" filter="url(#f6bct15kra8wp)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="134" x="941.5" y="81.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="120" x="948.5" y="102.0234">User Filestore API</text><rect fill="#FEFECE" filter="url(#f6bct15kra8wp)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="140" x="1089.5" y="81.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="126" x="1096.5" y="102.0234">Amazon SES Email</text><rect fill="#FEFECE" filter="url(#f6bct15kra8wp)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="159" x="1243.5" y="81.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="145" x="1250.5" y="102.0234">Submission Endpoint</text><rect fill="#FEFECE" filter="url(#f6bct15kra8wp)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="81" x="1416.5" y="81.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="1423.5" y="102.0234">Endpointt</text><rect fill="#FFFFFF" filter="url(#f6bct15kra8wp)" height="433.3477" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="284.5" y="187.5977"/><rect fill="#FFFFFF" filter="url(#f6bct15kra8wp)" height="68.6211" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="284.5" y="858.4531"/><rect fill="#FFFFFF" filter="url(#f6bct15kra8wp)" height="255.7949" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="453.5" y="296.5293"/><rect fill="#FFFFFF" filter="url(#f6bct15kra8wp)" height="57.3105" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="653.5" y="465.7031"/><rect fill="#FFFFFF" filter="url(#f6bct15kra8wp)" height="554.3027" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="653.5" y="804.832"/><rect fill="#FFFFFF" filter="url(#f6bct15kra8wp)" height="14" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="812" y="495.0137"/><rect fill="#FFFFFF" filter="url(#f6bct15kra8wp)" height="83.9316" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1005.5" y="971.3398"/><rect fill="#FFFFFF" filter="url(#f6bct15kra8wp)" height="14" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1156.5" y="1146.8926"/><rect fill="#FFFFFF" filter="url(#f6bct15kra8wp)" height="14" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1156.5" y="1245.5137"/><path d="M88,131.9766 L88,156.9766 L203,156.9766 L203,141.9766 L193,131.9766 L88,131.9766 " fill="#FBFB77" filter="url(#f6bct15kra8wp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M193,131.9766 L193,141.9766 L203,141.9766 L193,131.9766 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="94" x="94" y="149.5449">Check answers</text><polygon fill="#A80036" points="272.5,183.5977,282.5,187.5977,272.5,191.5977,276.5,187.5977" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="147.5" x2="278.5" y1="187.5977" y2="187.5977"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="154.5" y="182.8555">Submit application</text><path d="M201,200.5977 L201,240.5977 L374,240.5977 L374,210.5977 L364,200.5977 L201,200.5977 " fill="#FBFB77" filter="url(#f6bct15kra8wp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M364,200.5977 L364,210.5977 L374,210.5977 L364,200.5977 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="207" y="218.166">Add output urls</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="207" y="233.4766">--&gt; submission_details</text><polygon fill="#A80036" points="441.5,292.5293,451.5,296.5293,441.5,300.5293,445.5,296.5293" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="294.5" x2="447.5" y1="296.5293" y2="296.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="301.5" y="291.7871">POST /submission</text><path d="M299,309.5293 L299,395.5293 L520,395.5293 L520,319.5293 L510,309.5293 L299,309.5293 " fill="#FBFB77" filter="url(#f6bct15kra8wp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M510,309.5293 L510,319.5293 L520,319.5293 L510,309.5293 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="305" y="327.0977">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="309" y="342.4082">service_slug,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="309" y="357.7188">encrypted_user_id_and_token,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="309" y="373.0293">submission_details</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="305" y="388.3398">}</text><path d="M389,410.082 L389,435.082 L524,435.082 L524,420.082 L514,410.082 L389,410.082 " fill="#FBFB77" filter="url(#f6bct15kra8wp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M514,410.082 L514,420.082 L524,420.082 L514,410.082 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="395" y="427.6504">Add submissionId</text><polygon fill="#A80036" points="641.5,461.7031,651.5,465.7031,641.5,469.7031,645.5,465.7031" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="463.5" x2="647.5" y1="465.7031" y2="465.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="470.5" y="460.9609">Add to queue</text><polygon fill="#A80036" points="800,491.0137,810,495.0137,800,499.0137,804,495.0137" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="663.5" x2="806" y1="495.0137" y2="495.0137"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="670.5" y="490.2715">Store tasks</text><polygon fill="#A80036" points="674.5,505.0137,664.5,509.0137,674.5,513.0137,670.5,509.0137" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="668.5" x2="816" y1="509.0137" y2="509.0137"/><polygon fill="#A80036" points="474.5,519.0137,464.5,523.0137,474.5,527.0137,470.5,523.0137" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="468.5" x2="657.5" y1="523.0137" y2="523.0137"/><polygon fill="#A80036" points="305.5,548.3242,295.5,552.3242,305.5,556.3242,301.5,552.3242" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="299.5" x2="457.5" y1="552.3242" y2="552.3242"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="311.5" y="547.582">return {submissionId}</text><path d="M214,565.3242 L214,605.3242 L360,605.3242 L360,575.3242 L350,565.3242 L214,565.3242 " fill="#FBFB77" filter="url(#f6bct15kra8wp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M350,565.3242 L350,575.3242 L360,575.3242 L350,565.3242 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="121" x="220" y="582.8926">Store submissionId</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="220" y="598.2031">in UserData</text><polygon fill="#A80036" points="158.5,616.9453,148.5,620.9453,158.5,624.9453,154.5,620.9453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="152.5" x2="288.5" y1="620.9453" y2="620.9453"/><path d="M76,633.9453 L76,658.9453 L214,658.9453 L214,643.9453 L204,633.9453 L76,633.9453 " fill="#FBFB77" filter="url(#f6bct15kra8wp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M204,633.9453 L204,643.9453 L214,643.9453 L204,633.9453 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="82" y="651.5137">Confirmation page</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="148" x="691" y="717.8906">Task scheduled for workers</text><path d="M181,766.2109 L255,766.2109 L255,773.2109 L245,783.2109 L181,783.2109 L181,766.2109 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="304.0605" style="stroke: #000000; stroke-width: 2.0;" width="918.5" x="181" y="766.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="29" x="196" y="779.7793">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="116" x="270" y="778.8457">[Collate output files]</text><polygon fill="#A80036" points="674.5,800.832,664.5,804.832,674.5,808.832,670.5,804.832" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="668.5" x2="816" y1="804.832" y2="804.832"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="680.5" y="800.0898">Process output URL</text><path d="M191,819.832 L253,819.832 L253,826.832 L243,836.832 L191,836.832 L191,819.832 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="243.4395" style="stroke: #000000; stroke-width: 2.0;" width="898.5" x="191" y="819.832"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="206" y="833.4004">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="115" x="268" y="832.4668">[If generated output]</text><polygon fill="#A80036" points="305.5,854.4531,295.5,858.4531,305.5,862.4531,301.5,858.4531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="299.5" x2="652.5" y1="858.4531" y2="858.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="340" x="311.5" y="853.7109">GET /api/submitter/:outputType/:outputId/:filename?</text><path d="M201,871.4531 L201,896.4531 L374,896.4531 L374,881.4531 L364,871.4531 L201,871.4531 " fill="#FBFB77" filter="url(#f6bct15kra8wp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M364,871.4531 L364,881.4531 L374,881.4531 L364,871.4531 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="207" y="889.0215">Create requested output</text><polygon fill="#A80036" points="641.5,923.0742,651.5,927.0742,641.5,931.0742,645.5,927.0742" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="289.5" x2="647.5" y1="927.0742" y2="927.0742"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="296.5" y="922.332">return &lt;&lt;output&gt;&gt;</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="191" x2="1089.5" y1="936.0742" y2="936.0742"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="126" x="196" y="946.709">[if user-uploaded file]</text><polygon fill="#A80036" points="993.5,967.3398,1003.5,971.3398,993.5,975.3398,997.5,971.3398" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="663.5" x2="999.5" y1="971.3398" y2="971.3398"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="323" x="670.5" y="966.5977">GET /service/:serviceSlug/user/:userId/:fingerprint</text><path d="M836,984.3398 L836,1024.3398 L996,1024.3398 L996,994.3398 L986,984.3398 L836,984.3398 " fill="#FBFB77" filter="url(#f6bct15kra8wp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M986,984.3398 L986,994.3398 L996,994.3398 L986,984.3398 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="842" y="1001.9082">See User Filestore API</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="64" x="842" y="1017.2188">for details</text><polygon fill="#A80036" points="674.5,1051.2715,664.5,1055.2715,674.5,1059.2715,670.5,1055.2715" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="668.5" x2="1009.5" y1="1055.2715" y2="1055.2715"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="102" x="680.5" y="1050.5293">return &lt;&lt;file&gt;&gt;</text><path d="M119,1084.2715 L181,1084.2715 L181,1091.2715 L171,1101.2715 L119,1101.2715 L119,1084.2715 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="84.6211" style="stroke: #000000; stroke-width: 2.0;" width="1124.5" x="119" y="1084.2715"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="134" y="1097.8398">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="80" x="196" y="1096.9063">[if user email]</text><path d="M476,1106.582 L476,1131.582 L836,1131.582 L836,1116.582 L826,1106.582 L476,1106.582 " fill="#FBFB77" filter="url(#f6bct15kra8wp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M826,1106.582 L826,1116.582 L836,1116.582 L826,1106.582 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="339" x="482" y="1124.1504">Send confirmation email + application answers as pdf</text><polygon fill="#A80036" points="1144.5,1142.8926,1154.5,1146.8926,1144.5,1150.8926,1148.5,1146.8926" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="663.5" x2="1150.5" y1="1146.8926" y2="1146.8926"/><polygon fill="#A80036" points="158.5,1156.8926,148.5,1160.8926,158.5,1164.8926,154.5,1160.8926" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="152.5" x2="1160.5" y1="1160.8926" y2="1160.8926"/><path d="M13,1182.8926 L75,1182.8926 L75,1189.8926 L65,1199.8926 L13,1199.8926 L13,1182.8926 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="84.6211" style="stroke: #000000; stroke-width: 2.0;" width="1230.5" x="13" y="1182.8926"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="28" y="1196.4609">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="127" x="90" y="1195.5273">[if service team email]</text><path d="M367,1205.2031 L367,1230.2031 L945,1230.2031 L945,1215.2031 L935,1205.2031 L367,1205.2031 " fill="#FBFB77" filter="url(#f6bct15kra8wp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M935,1205.2031 L935,1215.2031 L945,1215.2031 L935,1205.2031 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="557" x="373" y="1222.7715">Send confirmation email + application answers in requested format + any uploaded files</text><polygon fill="#A80036" points="1144.5,1241.5137,1154.5,1245.5137,1144.5,1249.5137,1148.5,1245.5137" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="663.5" x2="1150.5" y1="1245.5137" y2="1245.5137"/><polygon fill="#A80036" points="82,1255.5137,72,1259.5137,82,1263.5137,78,1259.5137" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="76" x2="1160.5" y1="1259.5137" y2="1259.5137"/><path d="M557,1281.5137 L619,1281.5137 L619,1288.5137 L609,1298.5137 L557,1298.5137 L557,1281.5137 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="70.6211" style="stroke: #000000; stroke-width: 2.0;" width="954.5" x="557" y="1281.5137"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="572" y="1295.082">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="74" x="634" y="1294.1484">[if endpointt]</text><path d="M567,1303.8242 L567,1328.8242 L745,1328.8242 L745,1313.8242 L735,1303.8242 L567,1303.8242 " fill="#FBFB77" filter="url(#f6bct15kra8wp)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M735,1303.8242 L735,1313.8242 L745,1313.8242 L735,1303.8242 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="573" y="1321.3926">Submit data to endpointt</text><polygon fill="#A80036" points="1447,1340.1348,1457,1344.1348,1447,1348.1348,1451,1344.1348" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="663.5" x2="1453" y1="1344.1348" y2="1344.1348"/><!--
@startuml
hide footbox
title Data submission sequence

actor "Service Team" as ServiceTeam

actor User as User

box
boundary Runner as Runner
endbox

box
participant "Submittter API" as SubmitterAPI

participant "Submitter Workers" as SubmitterWorkers

participant "Submitter Database" as SubmitterDB

participant "User Filestore API" as FilestoreAPI
endbox

participant "Amazon SES Email" as Email
participant "Submission Endpoint" as Endpoint

Note over User: Check answers

User -> Runner : Submit application

activate Runner

Note over Runner : Add output urls\n- -> submission_details

|||

Runner -> SubmitterAPI : POST /submission

activate SubmitterAPI

Note right of Runner : { \n service_slug, \n encrypted_user_id_and_token, \n submission_details \n}

Note over SubmitterAPI : Add submissionId

SubmitterAPI -> SubmitterWorkers : Add to queue

activate SubmitterWorkers

SubmitterWorkers -> SubmitterDB ++ : Store tasks
SubmitterDB - -> SubmitterWorkers - -

SubmitterWorkers - -> SubmitterAPI

deactivate SubmitterWorkers

SubmitterAPI - -> Runner : return {submissionId}

deactivate SubmitterAPI

Note over Runner : Store submissionId \nin UserData

Runner - -> User

deactivate Runner

Note over User: Confirmation page

|||
... Task scheduled for workers ...
|||

loop Collate output files

  SubmitterDB -> SubmitterWorkers : Process output URL

  activate SubmitterWorkers

  alt If generated output

    SubmitterWorkers -> Runner : GET /api/submitter/:outputType/:outputId/:filename?

    activate Runner

    Note over Runner : Create requested output

    Runner - -> SubmitterWorkers : return <<output>>

    deactivate Runner

    else if user-uploaded file

    SubmitterWorkers -> FilestoreAPI : GET /service/:serviceSlug/user/:userId/:fingerprint

    activate FilestoreAPI

    Note left of FilestoreAPI: See User Filestore API \nfor details

    FilestoreAPI - -> SubmitterWorkers : return <<file>>

    deactivate FilestoreAPI

  end

end

alt if user email
Note over SubmitterWorkers: Send confirmation email + application answers as pdf
SubmitterWorkers -> Email
activate Email
Email -> User
deactivate Email
end

alt if service team email
Note over SubmitterWorkers: Send confirmation email + application answers in requested format + any uploaded files
SubmitterWorkers -> Email
activate Email
Email -> ServiceTeam
deactivate Email
end

alt if endpointt
Note over SubmitterWorkers: Submit data to endpointt
SubmitterWorkers -> Endpointt
end


deactivate SubmitterWorkers


@enduml

PlantUML version 1.2018.14(Fri Dec 21 16:33:16 GMT 2018)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 12.0.1+12
Operating System: Mac OS X
OS Version: 10.13.6
Default Encoding: UTF-8
Language: en
Country: GB
--></g></svg>